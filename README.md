<p style="width: 100%">
<img src="https://github.com/we-like-parsers/pegen/raw/main/media/logo.svg" style="display: block; margin: 0 auto; width: 70%">
</p>

-----------------------------------

[![Downloads](https://pepy.tech/badge/pegen/month)](https://pepy.tech/project/pegen)
[![PyPI version](https://badge.fury.io/py/pegen.svg)](https://badge.fury.io/py/pegen)
![CI](https://github.com/we-like-parsers/pegen/actions/workflows/test.yml/badge.svg)

What is this?
-------------
[This README is outdated]

Pegen is the parser generator used in CPython to produce the parser used by the interpreter. It allows to
produce PEG parsers from a description of a formal Grammar.

### About this fork
Pegen's logic is tied to the way Python is parsed. This fork tries to decouple
Pegen's logic with Python language's, as well as try some kinds of modifications.

Incomplete list of notable changes compared to [original repo](https://github.com/we-like-parsers/pegen):
- Implement `skip_actions` option
- Refactor `build` module, making it more straightforward
- [Breaking change] Rename Parser._mark → mark and Parser._reset → reset
  <!--Commit: 7c076908935cf7980c72232d45996aa62c55327a-->
  - Effect: Pegen parsers <u>generated</u> *before* the change
    need an installation of Pegen *before* the change; Pegen parsers <u>generated</u> *after* the change
    need an installation of Pegen *after* the change.

Also, though it doesn't affect users, the code is heavily refactored, some of which are obviously(?) opinionated.

Installing
----------
Install with `pip` or your favorite PyPI package manager.

```
pip install pegen
```

How to generate a parser
------------------------
Given a grammar file compatible with `pegen` (you can write your own or start with one in the [`data`](data) directory):

### Command line
Generate a parser by running:

```
python -m pegen <path-to-grammar-file> -o parser.py
```

This will generate a file called `parser.py` in the current directory. This can be used to parse code using the grammar that
we just used:

```
python parser.py <file-with-code-to-parse>
```

### As a library
```python
from pegen.build_v2 import generate_parser_from_file
parser_class = generate_parser_from_file("data/expr.gram")
parser = parser_class.from_text("1 + 2")
print(parser.start())
```

Documentation
-------------
The documentation is available [here](https://we-like-parsers.github.io/pegen/).

Also an incomplete guide in doc.md.

How to contribute
-----------------
See the instructions in the [CONTRIBUTING.md](CONTRIBUTING.md) file.

Differences with CPython's Pegen
--------------------------------
This repository exists to distribute a version of the Python PEG parser generator used by CPython that can be installed via PyPI,
with some improvements. Although the official PEG generator included in CPython can generate both Python and C code, this distribution
of the generator only allows to generate Python code. This is due to the fact that the C code generated by the generator included
in CPython includes a lot of implementation details and private headers that are not available for general usage.

The official PEG generator for Python 3.9 and later is now included in the CPython repo under
[Tools/peg_generator/](https://github.com/python/cpython/tree/master/Tools/peg_generator). We aim to keep this repo in sync with the
Python generator from that version of `pegen`.

See also [PEP 617](https://www.python.org/dev/peps/pep-0617/).

Differences with original pegen
-------------------------------
[TODO]

Repository structure
--------------------
* The `src` directory contains the `pegen` source (the package itself).
* The `tests` directory contains the test suite for the `pegen` package.
* The `data` directory contains some example grammars compatible with `pegen`. This
  includes a [pure-Python version of the Python grammar](data/python.gram).
* The `docs` directory contains the documentation for the package.
* The `scripts` directory contains some useful scripts that can be used for visualizing
  grammars, benchmarking and other usages relevant to the development of the generator itself.
* The `stories` directory contains the backing files and examples for
  [Guido's series on PEG parser](https://medium.com/@gvanrossum_83706/peg-parsing-series-de5d41b2ed60).
